create table if not exists store_sales_1999 as (select * from store_sales where ss_sold_date_sk in 
(select ss_sold_date_sk from store_sales join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk where date_dim.d_year = 1999));
create table if not exists store_sales_2000 as (select * from store_sales where ss_sold_date_sk in 
(select ss_sold_date_sk from store_sales join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk where date_dim.d_year = 2000));
create table if not exists store_sales_2001 as (select * from store_sales where ss_sold_date_sk in 
(select ss_sold_date_sk from store_sales join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk where date_dim.d_year = 2001));
create table if not exists store_sales_2002 as (select * from store_sales where ss_sold_date_sk in 
(select ss_sold_date_sk from store_sales join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk where date_dim.d_year = 2002));

create table if not exists catalog_sales_1999 as (select * from catalog_sales where cs_sold_date_sk in 
(select cs_sold_date_sk from catalog_sales join date_dim on catalog_sales.cs_sold_date_sk = date_dim.d_date_sk where date_dim.d_year = 1999));
create table if not exists catalog_sales_2000 as (select * from catalog_sales where cs_sold_date_sk in 
(select cs_sold_date_sk from catalog_sales join date_dim on catalog_sales.cs_sold_date_sk = date_dim.d_date_sk where date_dim.d_year = 2000));
create table if not exists catalog_sales_2001 as (select * from catalog_sales where cs_sold_date_sk in 
(select cs_sold_date_sk from catalog_sales join date_dim on catalog_sales.cs_sold_date_sk = date_dim.d_date_sk where date_dim.d_year = 2001));
create table if not exists catalog_sales_2002 as (select * from catalog_sales where cs_sold_date_sk in 
(select cs_sold_date_sk from catalog_sales join date_dim on catalog_sales.cs_sold_date_sk = date_dim.d_date_sk where date_dim.d_year = 2002));

create table if not exists web_sales_1999 as (select * from web_sales where ws_sold_date_sk in 
(select ws_sold_date_sk from web_sales join date_dim on web_sales.ws_sold_date_sk = date_dim.d_date_sk where date_dim.d_year = 1999));
create table if not exists web_sales_2000 as (select * from web_sales where ws_sold_date_sk in 
(select ws_sold_date_sk from web_sales join date_dim on web_sales.ws_sold_date_sk = date_dim.d_date_sk where date_dim.d_year = 2000));
create table if not exists web_sales_2001 as (select * from web_sales where ws_sold_date_sk in 
(select ws_sold_date_sk from web_sales join date_dim on web_sales.ws_sold_date_sk = date_dim.d_date_sk where date_dim.d_year = 2001));
create table if not exists web_sales_2002 as (select * from web_sales where ws_sold_date_sk in 
(select ws_sold_date_sk from web_sales join date_dim on web_sales.ws_sold_date_sk = date_dim.d_date_sk where date_dim.d_year = 2002));